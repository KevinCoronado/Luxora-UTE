<!DOCTYPE html>
<html lang="es">
<head>
    
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compras de la plataforma</title>
    <link rel="stylesheet" href="estilos.css?v=<?php echo time(); ?">
</head>
<body>
    <div class="navbar">
        <a href="inicio.html" class="logo-link">
            <img src="imagenes/luxora_logo.png" alt="logo" class="logo">
        </a>
        <div class="nav-links">
            <a href="#">Usuarios</a>
            <a href="#">Compras</a>
            <a href="#">Artículos</a>
            <a href="#">Mi perfil</a>
        </div>
    </div>
    <div class="containerCompras">
        <h2>Registro de compras</h2>
        <div class="search-container">
            <input type="text" id="searchInput" placeholder="Buscar por correo...">
        </div>
        <table>
            <thead>
                <tr>
                    <th>Id Compra</th>
                    <th>Nombre</th>
                    <th>Correo</th>
                    <th>Articulo</th>
                    <th>Marca</th>
                    <th>Talla</th>
                    <th>Fecha de Compra</th>
                    <th>Fecha de llegada estimada</th>
                    <th>Precio MXN</th>
                </tr>
                
            </thead>
            <tbody id="comprasTableBody">
    
            </tbody>
        </table>
    
        <div id="pagination" class="pagination">
            <!-- Paginación será añadida aquí dinámicamente -->
        </div>
    </div>


    <script>
        
            const comprasPorPagina = 15;
            let paginaActual = 1;
            let compras = [];
            let comprasFiltradas = [];

            
        
            function mostrarCompras(pagina) {
                const tablaCuerpo = document.getElementById('comprasTableBody');
                tablaCuerpo.innerHTML = '';
        
                const inicio = (pagina - 1) * comprasPorPagina;
                const fin = inicio + comprasPorPagina;
                const comprasPagina = comprasFiltradas.slice(inicio, fin);
        
                comprasPagina.forEach(compra => {
                    const fila = document.createElement('tr');
                    fila.innerHTML = `
                        <td>${compra.Id_compra}</td>
                        <td>${compra.Nombre}</td>
                        <td>${compra.Correo}</td>
                        <td>${compra.Articulo}</td>
                        <td>${compra.Marca}</td>
                        <td>${compra.Talla}</td>
                        <td>${compra.FechaCompra}</td>
                        <td>${compra.FechaLlegada}</td>
                        <td>${compra.PrecioMXN}</td>
                    `;
                    tablaCuerpo.appendChild(fila);
                });
        
                actualizarPaginacion();
            }

            function fetchCompras() {
                fetch('php/ver_compras.php')
                    .then(response => response.json())
                    .then(data => {
                        compras = data;
                        comprasFiltradas = compras;
                        mostrarCompras(paginaActual);
                    })
                    
                    .catch(error => console.error('Error al obtener las compras:', error));
                    
            }
        
            function actualizarPaginacion() {
                const paginacion = document.getElementById('pagination');
                paginacion.innerHTML = '';
        
                const numPaginas = Math.ceil(comprasFiltradas.length / comprasPorPagina);
        
                for (let i = 1; i <= numPaginas; i++) {
                    const boton = document.createElement('button');
                    boton.textContent = i;
                    boton.className = i === paginaActual ? 'active' : '';
                    boton.addEventListener('click', function() {
                        paginaActual = i;
                        mostrarCompras(paginaActual);
                    });
                    paginacion.appendChild(boton);
                }
            }
        
            function filtrarCompras() {
                const query = document.getElementById('searchInput').value.toLowerCase();
                comprasFiltradas = compras.filter(compra => 
                    compra.Correo.toLowerCase().includes(query)
                );
                paginaActual = 1; // Reiniciar a la primera página
                mostrarCompras(paginaActual);
            }
        
            // Manejar la entrada de búsqueda
            document.getElementById('searchInput').addEventListener('input', filtrarCompras);
            
            fetchCompras();

        
    </script>
</body>


</html>